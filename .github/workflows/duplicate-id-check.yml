name: ğŸ§ª Duplicate Challenge ID Check

on:
  pull_request:
    paths:
      - 'challenges/**/challenge.json'

jobs:
  check-duplicate-ids:
    name: ğŸ” ÃœberprÃ¼fe auf doppelte Challenge-IDs
    runs-on: ubuntu-latest

    steps:
      - name: ğŸ“¦ Repository auschecken
        uses: actions/checkout@v3

      - name: ğŸ” Durchsuche alle challenge.json-Dateien
        run: |
          echo "ğŸ” Scanne alle challenge.json Dateien..."

          # Finde alle IDs
          IDS=$(find challenges -type f -name 'challenge.json' -exec jq -r '.id' {} \;)

          echo "âœ… Gefundene IDs:"
          echo "$IDS"

          # PrÃ¼fe auf Duplikate
          DUPLICATES=$(echo "$IDS" | sort | uniq -d)

          if [ -n "$DUPLICATES" ]; then
            echo ""
            echo "âŒ Doppelte Challenge-IDs gefunden:"
            echo "$DUPLICATES"
            echo ""
            echo "ğŸ”´ Bitte stelle sicher, dass jede challenge.json eine eindeutige 'id' hat."
            exit 1
          else
            echo "âœ… Keine Duplikate gefunden."
          fi
